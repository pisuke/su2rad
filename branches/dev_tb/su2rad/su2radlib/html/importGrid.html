<!--
    Copyright 2009 Thomas Bleicher (tbleicher@googlemail.com).

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
    <head>
        <title>su2rad - import grid results</title>
        
        <!-- log panel for debugging -->
        <script type="text/javascript" src="./blackbirdjs/blackbird.js"></script>
        
        <!-- jquery and plugins -->
        <script type="text/javascript" src="./js/lib/jquery-1.2.6.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.alphanumeric.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.filetree.js"></script>
        <script type="text/javascript" src="./js/lib/jqModal.js"></script>
        
        <!--[if IE]><script type="text/javascript" src="./js/lib/excanvas.js"></script><![endif]-->
        <script type="text/javascript" src="./js/lib/canvas.text.js"></script>
        <script type="text/javascript" src="./js/lib/faces/arial-normal-normal.js"></script>
          
        <!-- su2rad specific javascript files -->
        <script type="text/javascript" src="./js/su2rad.dialog.common.js"></script>
        <script type="text/javascript" src="./js/su2rad.fileselector.js"></script>
        <script type="text/javascript" src="./js/su2rad.gridCanvas.js"></script>
        <script type="text/javascript" src="./js/su2rad.gridImport.js"></script>
        
        <script type="text/javascript">
            // set environment
            if (navigator.userAgent.indexOf("Windows") != -1) {
                var PATHSEP = "/";    // helps with file handling in Ruby
                var PLATFORM = "Windows";
            } else {
                var PATHSEP = "/";
                var PLATFORM = "Mac";
            }
            var SKETCHUP = false;
            var NSIDOM = false;
            
            // relevant for grid 
            var canvas, ctx, gArray;

            function initPage() {
                // set up canvas
                gCanvas = new GridCanvas();
                gCanvas.setCanvasId('cv');
                evaluateSketchup()  // just in case
            }

            
            $().ready(function() {
                // executed before <body onload()>
                $('#fileSelectorWindow').jqm();
                $('#fileSelectorWindow').jqmAddTrigger('#loadFileSU');
                $('#legendMaxInput').numeric({allow:".-"});
                $('#legendMinInput').numeric({allow:".-"});
                $('#legendStepsInput').numeric();
            });


        </script>
        
        <link rel="stylesheet" href="./blackbirdjs/blackbird.css" type="text/css" media="screen">
        <link rel="stylesheet" href="./css/dialog.css"            type="text/css" media="print, projection, screen">
        <link rel="stylesheet" href="./css/jqModal.css"           type="text/css" media="screen">
        <link rel="stylesheet" href="./css/jquery.tabs.css"       type="text/css" media="print, projection, screen">
        <link rel="stylesheet" href="./css/jquery.filetree.css"   type="text/css"  media="screen" />
        <!-- Additional IE/Win specific style sheet (Conditional Comments) -->
        <!--[if lte IE 8]>
        <link rel="stylesheet" href="./css/jquery.tabs-ie.css" type="text/css" media="projection, screen">
        <link rel="stylesheet" href="./css/dialog-ie.css" type="text/css" media="print, projection, screen">
        <![endif]-->
        
        <style>
            canvas {
                border:1px solid #444;
                float: left;
            }
	</style>
    </head>
    <body onload="initPage();">
    
        <!-- file selector popup -->
        <div class="jqmWindow2" id="fileSelectorWindow">
            <h3>Select file ...</h3>
            <div id="fileSelectorTree" class="fileSelector"></div>
            <div id="fileSelectorNote">selected: </div>
            <input class="exportbutton" type="button" id="fileSelectorButtonSelect" value="select file" onclick="fileSelector.select()" disabled>
            <input class="exportbutton" type="button" id="fileSelectorButtonCancel" value="cancel" onclick="fileSelector.close()">
        </div>
        
        <!-- show log button (top right) -->
        <input type="button" id="showLogButton" name="showLogButton" value="log" onclick="log.toggle()">
        
        <!-- show log button (top right) -->
        <h3 id="pageTitle" style="margin-top: 20px;">import grid results</h3>

        
        <!-- the canvas -->
        <canvas id="cv" width="600" height="400"></canvas>
        
        <!-- graph options -->
        <div id="graphOptionsPanel">
            <!-- load button options --> 
            <div id="loadFileSelectionDiv" style="background-color: lightblue; display: none;">
                <input type="file" id="loadFileSelection" style="width: 10px;" onchange="loadFileIDOM()" />
            </div>
            <div class="gridRow" id="loadFileSUDiv" style="background-color: lightblue;">
                <input type="button" value="load file" id="loadFileSU" style="width: 135px;" onclick="loadFileSU()" />
            </div>
            <div id="loadFileWarning" style="margin: 3px; border: 2px solid darkred; text-align: center;  display: none;">
                <span style="font-weight: bold; font-size: 12px; color: darkred;">You
                    need Firefox/Mozilla or Sketchup to load a results file.</span>
                <input type="button" style="width: 135px;" value="simulate" onclick="simulateGrid()">
            </div>
            
            <div id="graphOptions"> 
                <div class="gridRow" style="background-color: lightblue;">
                    <span class="gridLabel" style="width: 130px">legend options</span>
                </div>
                <div class="gridRow" style="vertical-align: bottom">
                    <span class="gridLabel">min value</span>
                    <span>
                        <input type="text" style="margin: 0; padding: 0; width:50px; position: relative; top: 1px;" width="10" value="0" name="legendMinInput" id="legendMinInput" onchange="setLegendMin(this.value)"/>
                    </span>
                </div>
                <div class="gridRow">
                    <span class="gridLabel">max value</span>
                    <span>
                        <input type="text" style="width:50px; position: relative; top: 1px;" width="10" value="100" name="legendMaxInput" id="legendMaxInput" onchange="setLegendMax(this.value)"/>
                    </span>
                </div>
                <div class="gridRow">
                    <span class="gridLabel">steps</span>
                    <span>
                        <input type="text" style="width:50px; position: relative; top: 1px;" width="5" value="10" name="legendStepsInput" id="legendStepsInput" onchange="setLegendSteps(this.value)"/>
                    </span>
                </div>
            </div>
            <div id="statsDiv"> 
                <div class="gridRow" style="background-color: lightblue;">
                    <span class="gridLabel">statistics</span>
                </div>
                <div id="statsTable"></div>
            </div>
            

            <!-- import button option only within Sketchup --> 
            <div class="gridRow" id="importGraphToSketchupDiv" style="background-color: lightblue; display: none;">
                <input type="button" value="import to SU" id="importToSketchup" style="width: 135px;" onclick="importGraphToSketchup()" />
            </div>
            
        </div>
        
        <!-- for debugging -->
        <textarea id="messagearea" name="messagearea" cols=80 rows=8>foo</textarea>
        
</body>
</html>
