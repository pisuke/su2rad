<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta http-equiv="Content-Style-Type" content="text/css">
        <meta http-equiv="Content-Script-Type" content="text/javascript">

        <title>Radiance Export</title>
        
        <!-- log panel for debugging -->
        <script type="text/javascript" src="./blackbirdjs/blackbird.js"></script>
        
        <!-- google map and jsr_class for geonames.org requests -->
	<!--
	<script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAVkCvvMxWS6sy1KKSLvN3URTDis0fJxnS-wzgwKhlyWVJxXLRhxQq9kdL_d2nO8XPOQO2xIrAWCmccw"></script>
	-->
	<script type="text/javascript" src="./js/lib/jsr_class.js"></script>
        
        <!-- jquery and plugins -->
        <!-- <script type="text/javascript" src="./js/lib/jquery-1.2.6.js"></script> -->
        <script type="text/javascript" src="./js/lib/jquery-1.3.2.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.history_remote.pack.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.tabs.pack.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.alphanumeric.js"></script>
        <script type="text/javascript" src="./js/lib/jquery.filetree.js"></script>
        <script type="text/javascript" src="./js/lib/jqModal.js"></script>
        <!--<script type="text/javascript" src="./js/lib/ui/ui.core.1.5.3.js"></script>
        <script type="text/javascript" src="./js/lib/ui/ui.draggable.1.5.3.js"></script>
        <script type="text/javascript" src="./js/lib/ui/ui.droppable.1.5.3.js"></script> -->
        <script type="text/javascript" src="./js/lib/ui/ui.core.1.7.2.js"></script>
        <script type="text/javascript" src="./js/lib/ui/ui.draggable.1.7.2.js"></script>
        <script type="text/javascript" src="./js/lib/ui/ui.droppable.1.7.2.js"></script>
        <script type="text/javascript" src="./js/lib/ui/ui.resizable.1.7.2.js"></script>
        
        <!--[if IE]><script type="text/javascript" src="./js/lib/excanvas.js"></script><![endif]-->
        <script type="text/javascript" src="./js/lib/canvas.text.js"></script>
        <script type="text/javascript" src="./js/lib/faces/arial-normal-normal.js"></script>
          
        <!-- su2rad specific javascript files -->
        <script type="text/javascript" src="./js/su2rad_tooltip.js"></script>
        <script type="text/javascript" src="./js/su2rad_test.js"></script>
        <script type="text/javascript" src="./js/su2rad.dialog.common.js"></script>
        <script type="text/javascript" src="./js/su2rad_backend_interface.js"></script>
        <script type="text/javascript" src="./js/su2rad.fileselector.js"></script>
        <script type="text/javascript" src="./js/su2rad_export.js"></script>
        <script type="text/javascript" src="./js/su2rad_views.js"></script>
        <script type="text/javascript" src="./js/su2rad_googlemap.js"></script>
        <script type="text/javascript" src="./js/su2rad_geonames.js"></script>
        <script type="text/javascript" src="./js/su2rad_sky.js"></script>
        <script type="text/javascript" src="./js/su2rad_location.js"></script>
        <script type="text/javascript" src="./js/su2rad_radopts.js"></script>
        <script type="text/javascript" src="./js/su2rad_materials.js"></script>
        <script type="text/javascript" src="./js/su2rad_dialog.js"></script>
        <script type="text/javascript" src="./js/su2rad.gridCanvas.js"></script>
        <script type="text/javascript" src="./js/su2rad.gridImport.js"></script>

        <script type="text/javascript">
            
            function initPage() {
                // bind fileSelector to setExportPath
                //fileSelector.callback = setExportPath
            }
            //log.toggle();
        </script>

        <script type="text/javascript">
            // set environment
            if (navigator.userAgent.indexOf("Windows") != -1) {
                var PATHSEP = "/";    // helps with file handling in Ruby
                var PLATFORM = "Windows";
            } else {
                var PATHSEP = "/";
                var PLATFORM = "Mac";
            }
            var SKETCHUP = false;
            var NSIDOM = false;
            
            // relevant for grid 
            var canvas, ctx, gArray;

            function initPage() {
                // set up canvas
                document.getElementById("messagearea").value = '';
                gCanvas = new GridCanvas();
                gCanvas.setCanvasId('cv');
                evaluateSketchup(); 
                updateUI();
            }

            function onResizeCanvas() {
                try {
                    var newW = document.getElementById("canvasContainer").clientWidth;
                    var newH = document.getElementById("canvasContainer").clientHeight;
                    document.getElementById("cv").width = newW;
                    document.getElementById("cv").height = newH;
                    gCanvas.draw()
                } catch (e) {
                    logError(e)
                }
            }
                
            /* create tabs */
            $(function() {
                $('#tab-container').tabs(1, {
                    //disabled: [5], 
                    onClick: function(a,s,h) { onTabClick(a,s,h); },
                    onHide:  function(a,s,h) { onTabHide(a,s,h); },
                    onShow:  function(a,s,h) { onTabShow(a,s,h); }
                } );
            });
            
            $().ready(function() {
                // executed before <body onload()>
                $('#fileSelectorWindow').jqm();
                $('#fileSelectorWindow').jqmAddTrigger('#loadFileSU');
                $('#legendMaxInput').numeric({allow:".-"});
                $('#legendMinInput').numeric({allow:".-"});
                $('#legendStepsInput').numeric();
                $('#legendLightnessInput').numeric({allow:".-"});
                $('#progressWindow').jqm();
                $('#progressWindow').jqmAddTrigger('.showProgress');
                $('#fileSelectorWindow').jqm();
                $('#fileSelectorWindow').jqmAddTrigger('.selectButton');
                // make canvas resizable
                $("#canvasContainer").resizable( {
                    stop: function (event, ui) {
                        onResizeCanvas()
                    }
                });
            });

        </script>
        
        <!-- style sheet for the rest of the dialog -->
        <link rel="stylesheet" href="./blackbirdjs/blackbird.css" type="text/css" media="screen">
        <link rel="stylesheet" href="./css/dialog.css"            type="text/css" media="print, projection, screen">
        <link rel="stylesheet" href="./css/jqModal.css"           type="text/css" media="screen">
        <link rel="stylesheet" href="./css/jquery.tabs.css"       type="text/css" media="print, projection, screen">
        <link rel="stylesheet" href="./css/jquery.filetree.css"   type="text/css" media="screen" />
        <link rel="stylesheet" href="./css/ui.resizable.css"      type="text/css" media="screen" />
        <!-- Additional IE/Win specific style sheet (Conditional Comments) -->
        <!--[if lte IE 8]>
        <link rel="stylesheet" href="./css/jquery.tabs-ie.css" type="text/css" media="projection, screen">
        <link rel="stylesheet" href="./css/dialog-ie.css" type="text/css" media="print, projection, screen">
        <![endif]-->
    
    </head>
    
    <body style="background-color: white" onLoad="initPage()">
        
        <!-- file selector popup -->
        <div class="jqmWindow2" id="fileSelectorWindow">
            <h3>Select file ...</h3>
            <div id="fileSelectorTree" class="fileSelector"></div>
            <div id="fileSelectorNote">selected: </div>
            <input class="exportbutton" type="button" id="fileSelectorButtonSelect" value="select file" onclick="fileSelector.select()" disabled>
            <input class="exportbutton" type="button" id="fileSelectorButtonCancel" value="cancel" onclick="fileSelector.close()">
        </div>
        
        <input type="button" id="showLogButton" name="showLogButton" value="log" onclick="log.toggle()">
    
        <div id="tab-container">
            <ul class="tabs-nav">
                <li><a href="#tab-fields"><span>Fields</span></a></li>
                <!-- <li><a href="#tab-render"><span>Render</span></a></li> -->
            </ul>

            
            <!-- TAB export -->
            
            <div id="tab-fields">

                <!-- title needs id to set filename -->
                <h3 id="pageTitle">import grid results</h3>
                
                <!-- the canvas -->
                <div style="clear: both;">
                <div id="canvasContainer">
                    <canvas id="cv" width="600" height="400"></canvas>
                    <!-- <div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonall-se" style="z-index: 1001; -moz-user-seelct: none;" unselectable="on" /> -->
                </div>
                
                <!-- graph options -->
                <div id="graphOptionsPanel">
                    
                    <!-- load button options --> 
                    <div class="importOptionHeader" id="loadFileSelectionDiv" style="display: none;">
                        <input type="file" class="file" size="5" id="loadFileSelection" onchange="loadFileIDOM()" />
                        <input type="button" id="loadFileButton" value="load file IDOM">
                    </div>
                    <div class="importOptionHeader" id="loadFileSUDiv">
                        <input type="button" id="loadFileSU" value="load file SU" onclick="loadFileSU()" />
                    </div>
                    <div id="loadFileWarning">
                        <span>You need Firefox/Mozilla or Sketchup to load a results file.</span>
                        <input type="button" id="simulateGrid" value="simulate" onclick="simulateGrid()">
                    </div>

                    <div id="graphOptions"> 
                        <div class="importOptionHeader">
                            <div>legend options</div>
                        </div>
                        <div>
                            <div class="gridRow">
                                <span class="gridLabel">min value</span>
                                <input type="text" width="10" value="0" id="legendMinInput" onchange="setLegendMin(this.value)"/>
                            </div>
                            <div class="gridRow">
                                <span class="gridLabel">max value</span>
                                <input type="text" width="10" value="100" id="legendMaxInput" onchange="setLegendMax(this.value)"/>
                            </div>
                            <div class="gridRow"
                                <span class="gridLabel">steps</span>
                                <input type="text" width="3" value="10" id="legendStepsInput" onchange="setLegendSteps(this.value)"/>
                            </div>
                            <div class="gridRow"
                                <span class="gridLabel">label</span>
                                <input type="text" width="20" value="" id="legendLabelInput" onchange="setLegendLabel(this.value)"/>
                            </div>
                            <div class="gridRow"
                                <span class="gridLabel">lightness</span>
                                <input type="text" width="4" value="0.4" id="legendLightnessInput" onchange="setLegendLightness(this.value)" />
                            </div>
                        </div>
                    </div>
                    
                    <div id="statsDiv"> 
                        <div class="importOptionHeader">
                            <div>statistics</div>
                        </div>
                        <div id="statsTable"></div>
                    </div>
                    
                    <!-- import button option only within Sketchup --> 
                    <div class="importOptionHeader" id="importGraphToSketchupDiv" style="display: none; margin-top: 10px;">
                        <input type="button" value="import to SU" id="importToSketchup" onclick="importGraphToSketchup()" />
                    </div>
                    
                </div>
                </div>
                
                <!-- for debugging -->
                <textarea id="messagearea" name="messagearea" cols=80 rows=4></textarea>
            
            </div>
            

            <!-- TAB render -->
            
            <div id="tab-render">
                <div class="statusMessage" id="status_tab-render" style="display:none;">
                    msg
                </div>
            </div>
             
        </div>
        <!-- end of tabs -->

    </body>
</html>
